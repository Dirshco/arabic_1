<!doctype html>
<html lang="en" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Arabic Alphabet Adventure</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    if (!window.elementSdk) {
      window.elementSdk = {
        init: (cfg) => { window.elementSdk.config = cfg.defaultConfig; cfg.onConfigChange(cfg.defaultConfig); },
        setConfig: (cfg) => { Object.assign(window.elementSdk.config, cfg); }
      };
    }
  </script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap');
    * { font-family: 'Tajawal', sans-serif; box-sizing: border-box; }
    
    .card-container { perspective: 1000px; height: 450px; width: 100%; max-width: 320px; }
    .card { 
      position: relative; width: 100%; height: 100%; 
      transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1); 
      transform-style: preserve-3d; 
    }
    .card.flipped { transform: rotateY(180deg); }
    
    .card-face {
      position: absolute; width: 100%; height: 100%;
      backface-visibility: hidden; -webkit-backface-visibility: hidden;
      border-radius: 2rem; display: flex; flex-direction: column;
      align-items: center; justify-content: center;
      box-shadow: 0 20px 40px rgba(0,0,0,0.1);
      border: 8px solid white;
    }
    
    .card-back { transform: rotateY(180deg); }
    
    @keyframes bounce {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }
    .bounce { animation: bounce 0.4s ease; }
  </style>
 </head>
 <body class="h-full">
  <div id="app" class="h-full w-full overflow-auto transition-colors duration-500"></div>

  <script>
    const defaultConfig = {
      background_color: "#F0F4FF",
      card_color: "#FFFFFF",
      primary_button_color: "#6366F1",
      secondary_button_color: "#A5B4FC",
      text_color: "#1E293B",
      game_title: "Arabic Alphabet Adventure ğŸŒŸ",
      instruction_text: "Flip the card to hear and learn the letter!",
      flip_button_text: "Reveal Letter ğŸ”„",
      next_button_text: "Next â¡ï¸",
      prev_button_text: "â¬…ï¸ Back"
    };

    const arabicLetters = [
      { letter: "Ø§", name: "Alif", transliteration: "a", image: "ğŸŒ™" },
      { letter: "Ø¨", name: "Ba", transliteration: "b", image: "ğŸ¦‹" },
      { letter: "Øª", name: "Ta", transliteration: "t", image: "â­" },
      { letter: "Ø«", name: "Tha", transliteration: "th", image: "ğŸŒº" },
      { letter: "Ø¬", name: "Jeem", transliteration: "j", image: "ğŸŒˆ" },
      { letter: "Ø­", name: "Ha", transliteration: "h", image: "ğŸ¨" },
      { letter: "Ø®", name: "Kha", transliteration: "kh", image: "ğŸª" },
      { letter: "Ø¯", name: "Dal", transliteration: "d", image: "ğŸµ" },
      { letter: "Ø°", name: "Thal", transliteration: "dh", image: "ğŸŒ»" },
      { letter: "Ø±", name: "Ra", transliteration: "r", image: "ğŸ" },
      { letter: "Ø²", name: "Zay", transliteration: "z", image: "ğŸŒ¸" },
      { letter: "Ø³", name: "Seen", transliteration: "s", image: "â˜€ï¸" },
      { letter: "Ø´", name: "Sheen", transliteration: "sh", image: "âœ¨" },
      { letter: "Øµ", name: "Sad", transliteration: "s", image: "ğŸ€" },
      { letter: "Ø¶", name: "Dad", transliteration: "d", image: "ğŸŒŸ" },
      { letter: "Ø·", name: "Taa", transliteration: "t", image: "ğŸ­" },
      { letter: "Ø¸", name: "Zha", transliteration: "z", image: "ğŸª" },
      { letter: "Ø¹", name: "Ayn", transliteration: "'", image: "ğŸ¦„" },
      { letter: "Øº", name: "Ghayn", transliteration: "gh", image: "ğŸŒº" },
      { letter: "Ù", name: "Fa", transliteration: "f", image: "ğŸ¨" },
      { letter: "Ù‚", name: "Qaf", transliteration: "q", image: "ğŸ¯" },
      { letter: "Ùƒ", name: "Kaf", transliteration: "k", image: "ğŸˆ" },
      { letter: "Ù„", name: "Lam", transliteration: "l", image: "ğŸŒˆ" },
      { letter: "Ù…", name: "Meem", transliteration: "m", image: "ğŸµ" },
      { letter: "Ù†", name: "Noon", transliteration: "n", image: "ğŸŒ™" },
      { letter: "Ù‡", name: "Ha", transliteration: "h", image: "â­" },
      { letter: "Ùˆ", name: "Waw", transliteration: "w", image: "ğŸ¦‹" },
      { letter: "ÙŠ", name: "Ya", transliteration: "y", image: "ğŸŒ»" }
    ];

    let currentIndex = 0;
    let isFlipped = false;

    function speak(text) {
      if ('speechSynthesis' in window) {
        speechSynthesis.cancel();
        const msg = new SpeechSynthesisUtterance(text);
        msg.lang = 'ar-SA';
        speechSynthesis.speak(msg);
      }
    }

    function renderApp() {
      const app = document.getElementById('app');
      const config = window.elementSdk.config || defaultConfig;
      const current = arabicLetters[currentIndex];

      app.style.backgroundColor = config.background_color;
      
      app.innerHTML = `
        <div class="flex flex-col items-center justify-between min-h-screen p-6 text-center">
          <div>
            <h1 class="text-3xl font-black mb-2" style="color: ${config.text_color}">${config.game_title}</h1>
            <p class="font-bold opacity-70" style="color: ${config.text_color}">${config.instruction_text}</p>
          </div>

          <div class="card-container my-8">
            <div class="card ${isFlipped ? 'flipped' : ''}" id="letterCard">
              <div class="card-face" style="background: ${config.card_color}">
                <div class="text-6xl mb-4">${current.image}</div>
                <div class="text-9xl font-black" style="color: ${config.text_color}" dir="rtl">${current.letter}</div>
              </div>
              <div class="card-face card-back" style="background: ${config.card_color}">
                <div class="text-5xl mb-2">${current.image}</div>
                <div class="text-8xl font-black mb-4" style="color: ${config.primary_button_color}" dir="rtl">${current.letter}</div>
                <div class="text-3xl font-black" style="color: ${config.text_color}">${current.name}</div>
                <div class="text-xl font-bold opacity-60" style="color: ${config.text_color}">"${current.transliteration}"</div>
              </div>
            </div>
          </div>

          <div class="w-full max-w-xs space-y-4">
            <button onclick="handleFlip()" class="w-full py-4 rounded-2xl text-white font-black text-xl shadow-lg transition-transform active:scale-95" 
                    style="background: ${config.primary_button_color}">
              ${config.flip_button_text}
            </button>
            <div class="flex gap-4">
              <button onclick="changeLetter(-1)" class="flex-1 py-3 rounded-xl text-white font-bold shadow-md active:scale-95" 
                      style="background: ${config.secondary_button_color}">
                ${config.prev_button_text}
              </button>
              <button onclick="changeLetter(1)" class="flex-1 py-3 rounded-xl text-white font-bold shadow-md active:scale-95" 
                      style="background: ${config.secondary_button_color}">
                ${config.next_button_text}
              </button>
            </div>
            <p class="font-black pt-2" style="color: ${config.text_color}">Letter ${currentIndex + 1} / 28</p>
          </div>
        </div>
      `;
    }

    window.handleFlip = () => {
      isFlipped = !isFlipped;
      const card = document.getElementById('letterCard');
      card.classList.toggle('flipped');
      card.classList.add('bounce');
      setTimeout(() => card.classList.remove('bounce'), 400);
      
      if(isFlipped) speak(arabicLetters[currentIndex].letter);
    };

    window.changeLetter = (dir) => {
      currentIndex = (currentIndex + dir + arabicLetters.length) % arabicLetters.length;
      isFlipped = false;
      renderApp();
    };

    // Initialize with SDK
    window.elementSdk.init({
      defaultConfig,
      onConfigChange: renderApp,
      mapToCapabilities: (cfg) => ({
        recolorables: [
          { get: () => cfg.background_color, set: (v) => { cfg.background_color = v; renderApp(); } }
        ]
      })
    });
  </script>
 </body>
</html>
