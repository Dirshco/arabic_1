<!doctype html>
<html lang="ar" dir="rtl" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ØªØ¹Ù„Ù… Ø§Ù„Ø£Ø³Ù…Ø§Ø¡</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap');
    
    * { font-family: 'Tajawal', sans-serif; box-sizing: border-box; }
    
    body { margin: 0; overflow-x: hidden; }

    .card { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); cursor: pointer; position: relative; }
    .card:hover { transform: translateY(-8px) scale(1.02); box-shadow: 0 20px 40px rgba(0,0,0,0.1); }
    
    .flipped-anim { animation: flip 0.6s ease-in-out; }
    
    @keyframes flip {
      0% { transform: rotateY(0deg); }
      50% { transform: rotateY(90deg); }
      100% { transform: rotateY(0deg); }
    }
    
    .balloon { animation: float 3s ease-in-out infinite; display: inline-block; }
    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-15px); }
    }

    .level-badge { transition: all 0.3s ease; }
    .level-badge:active { transform: scale(0.95); }
    
    .matched { transform: scale(0); opacity: 0; pointer-events: none; transition: all 0.5s ease; }
  </style>
 </head>
 <body class="h-full">
  <div id="app" class="w-full min-h-full"></div>
  <script>
    const defaultConfig = {
      app_title: "ğŸ® ØªØ¹Ù„Ù… Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ ğŸ®",
      game_instruction: "Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ù„Ø³Ù…Ø§Ø¹ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡!",
      background_color: "#FFE5F1",
      card_color: "#FFFFFF",
      primary_color: "#FF6B9D",
      secondary_color: "#4ECDC4",
      text_color: "#2C3E50"
    };

    const namesLevel1 = [
      { name: "Ù…ÙƒÙŠ", emoji: "ğŸŒ¸", color: "#FF6B9D" }, { name: "Ø³Ø§Ø±Ø©", emoji: "ğŸŒº", color: "#FFB6C1" },
      { name: "Ø£Ø­Ù…Ø¯", emoji: "âš½", color: "#4ECDC4" }, { name: "Ù„Ø§Ù†Ø§", emoji: "ğŸ¦‹", color: "#9B59B6" },
      { name: "Ø±Ù†Ø§", emoji: "ğŸŒŸ", color: "#F39C12" }, { name: "Ø²ÙŠÙ†Ø¨", emoji: "ğŸŒ·", color: "#E74C3C" },
      { name: "Ù…Ø­Ù…Ø¯", emoji: "ğŸš€", color: "#3498DB" }, { name: "Ø­Ø³Ø§Ù…", emoji: "âš¡", color: "#2ECC71" },
      { name: "Ø±Ø²Ø§Ù†", emoji: "ğŸ¨", color: "#E67E22" }, { name: "Ø±Ù†Ø§Ø¯", emoji: "ğŸµ", color: "#1ABC9C" },
      { name: "Ø¢ÙŠØ©", emoji: "ğŸ“š", color: "#9B59B6" }, { name: "Ù…Ø§ÙŠØ§", emoji: "ğŸŒˆ", color: "#FF6B9D" },
      { name: "ÙŠØ§Ø±Ø§", emoji: "ğŸ€", color: "#FFB6C1" }, { name: "Ø¥ÙŠØ§Ø¯", emoji: "ğŸª", color: "#F39C12" },
      { name: "ÙØ§Ø±Ø³", emoji: "ğŸ¯", color: "#E74C3C" }, { name: "ÙŠØ§Ø³Ù…ÙŠÙ†", emoji: "ğŸŒ»", color: "#2ECC71" }
    ];

    const namesLevel2 = [
      { name: "ÙˆØ§Ø«Ù‚", emoji: "ğŸ’ª", color: "#FF6B9D" }, { name: "Ù‡Ù†Ø§Ø¡", emoji: "ğŸ˜Š", color: "#FFB6C1" },
      { name: "Ø³Ù…Ø§Ø­", emoji: "ğŸŒ™", color: "#4ECDC4" }, { name: "Ø³Ù‡ÙŠØ±", emoji: "âœ¨", color: "#9B59B6" },
      { name: "Ø³Ø­Ø±", emoji: "ğŸ­", color: "#F39C12" }, { name: "Ù†Ø§Ø¯Ø±", emoji: "ğŸ’", color: "#E74C3C" },
      { name: "Ø±ÙŠÙ…", emoji: "ğŸ¦Œ", color: "#3498DB" }, { name: "Ø¹Ù…Ø±", emoji: "ğŸƒ", color: "#2ECC71" },
      { name: "Ù‡Ø´Ø§Ù…", emoji: "ğŸ“", color: "#E67E22" }, { name: "Ø¹ØµÙ…Øª", emoji: "ğŸ›¡ï¸", color: "#1ABC9C" },
      { name: "Ù…Ø§Ù„Ùƒ", emoji: "ğŸ‘‘", color: "#9B59B6" }, { name: "ÙŠØ§Ø³ÙŠÙ†", emoji: "ğŸ•Œ", color: "#FF6B9D" },
      { name: "Ø£ÙŠÙ…Ù†", emoji: "ğŸŒŸ", color: "#FFB6C1" }, { name: "Ø²ÙŠÙ†", emoji: "ğŸ¨", color: "#F39C12" },
      { name: "Ø²ÙŠØ§Ø¯", emoji: "ğŸš´", color: "#E74C3C" }, { name: "Ø¹Ø¯Ù†", emoji: "ğŸŒŠ", color: "#2ECC71" }
    ];

    let currentLevel = 1;
    let currentMode = 'cards';
    let score = 0;
    let matchesFound = 0;
    let firstCard = null;
    let lockBoard = false;
    let memoryPairs = [];

    function speakName(name) {
      if ('speechSynthesis' in window) {
        speechSynthesis.cancel();
        const utterance = new SpeechSynthesisUtterance(name);
        utterance.lang = 'ar-SA';
        utterance.rate = 0.9;
        // Optimization for some browsers where voices need to load
        const voices = speechSynthesis.getVoices();
        const arVoice = voices.find(v => v.lang.includes('ar'));
        if (arVoice) utterance.voice = arVoice;
        speechSynthesis.speak(utterance);
      }
    }

    function shuffleArray(array) {
      return [...array].sort(() => Math.random() - 0.5);
    }

    window.switchLevel = function(lvl) {
      currentLevel = lvl;
      if (currentMode === 'memory') initializeMemoryGame();
      render();
    };

    window.switchMode = function(mode) {
      currentMode = mode;
      firstCard = null;
      lockBoard = false;
      if (mode === 'memory') initializeMemoryGame();
      render();
    };

    function initializeMemoryGame() {
      const names = shuffleArray(currentLevel === 1 ? namesLevel1 : namesLevel2).slice(0, 6);
      memoryPairs = shuffleArray([...names, ...names]);
      matchesFound = 0;
    }

    function renderLevelButtons() {
      const config = defaultConfig;
      return `
        <div class="flex justify-center gap-4 mb-6">
          <button style="background: ${currentLevel === 1 ? config.primary_color : '#CBD5E0'};"
            class="level-badge px-6 py-2 rounded-full text-lg font-black shadow-md text-white" onclick="switchLevel(1)">ğŸ¥‡ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 1</button>
          <button style="background: ${currentLevel === 2 ? config.primary_color : '#CBD5E0'};"
            class="level-badge px-6 py-2 rounded-full text-lg font-black shadow-md text-white" onclick="switchLevel(2)">ğŸ¥ˆ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 2</button>
        </div>`;
    }

    function renderGameModeButtons() {
      const config = defaultConfig;
      return `
        <div class="flex justify-center gap-3 flex-wrap mb-8">
          <button style="background: ${currentMode === 'cards' ? config.secondary_color : '#A0AEC0'};"
            class="px-5 py-2 rounded-xl text-lg font-black shadow text-white" onclick="switchMode('cards')">ğŸƒ ØªØµÙØ­</button>
          <button style="background: ${currentMode === 'memory' ? config.secondary_color : '#A0AEC0'};"
            class="px-5 py-2 rounded-xl text-lg font-black shadow text-white" onclick="switchMode('memory')">ğŸ§  Ø°Ø§ÙƒØ±Ø©</button>
          <button style="background: ${currentMode === 'quiz' ? config.secondary_color : '#A0AEC0'};"
            class="px-5 py-2 rounded-xl text-lg font-black shadow text-white" onclick="switchMode('quiz')">ğŸ“ Ø§Ø®ØªØ¨Ø§Ø±</button>
        </div>`;
    }

    window.handleCardClick = function(index, el) {
      el.classList.add('flipped-anim');
      const names = currentLevel === 1 ? namesLevel1 : namesLevel2;
      speakName(names[index].name);
      setTimeout(() => el.classList.remove('flipped-anim'), 600);
    };

    window.handleMemoryClick = function(el, index) {
      if (lockBoard || el.classList.contains('matched') || el === firstCard) return;
      
      const config = defaultConfig;
      const item = memoryPairs[index];
      
      el.innerHTML = `<div class="flex flex-col items-center"><span class="text-4xl">${item.emoji}</span><span class="text-sm font-bold mt-1" style="color:${config.text_color}">${item.name}</span></div>`;
      el.style.background = config.card_color;
      speakName(item.name);

      if (!firstCard) {
        firstCard = el;
        firstCard.dataset.index = index;
        return;
      }

      lockBoard = true;
      const firstItem = memoryPairs[firstCard.dataset.index];
      
      if (firstItem.name === item.name) {
        score += 10;
        matchesFound++;
        setTimeout(() => {
            el.classList.add('matched');
            firstCard.classList.add('matched');
            document.getElementById('score').textContent = score;
            firstCard = null;
            lockBoard = false;
            if (matchesFound === memoryPairs.length / 2) {
              setTimeout(() => {
                  alert("ğŸ‰ Ø±Ø§Ø¦Ø¹! Ù„Ù‚Ø¯ ÙˆØ¬Ø¯Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø²ÙˆØ§Ø¬! ğŸ‰");
                  initializeMemoryGame();
                  render();
              }, 500);
            }
        }, 500);
      } else {
        setTimeout(() => {
          el.innerHTML = "â“"; el.style.background = config.primary_color;
          firstCard.innerHTML = "â“"; firstCard.style.background = config.primary_color;
          firstCard = null; lockBoard = false;
        }, 1000);
      }
    };

    window.handleQuizAnswer = function(selected, correct, btn) {
      const feedback = document.getElementById('quiz-feedback');
      if (selected === correct) {
        btn.style.background = "#2ECC71";
        feedback.innerHTML = "ğŸ‰ Ø£Ø­Ø³Ù†Øª! Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©";
        feedback.style.color = "#2ECC71";
        score += 5;
        document.getElementById('quiz-score').textContent = score;
        speakName(correct);
        setTimeout(render, 1500);
      } else {
        btn.style.background = "#E74C3C";
        feedback.innerHTML = "âŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰";
        feedback.style.color = "#E74C3C";
        speakName("Ø®Ø·Ø£");
        setTimeout(() => { btn.style.background = defaultConfig.secondary_color; }, 1000);
      }
    };

    function render() {
      const app = document.getElementById('app');
      const config = defaultConfig;
      const names = currentLevel === 1 ? namesLevel1 : namesLevel2;

      let content = `<div style="background: ${config.background_color};" class="w-full min-h-screen p-4 text-center">
        <h1 style="color: ${config.primary_color};" class="text-4xl font-black mb-2 balloon">${config.app_title}</h1>
        ${renderLevelButtons()}
        ${renderGameModeButtons()}`;

      if (currentMode === 'cards') {
        content += `
          <p style="color: ${config.text_color};" class="text-xl font-bold mb-6">${config.game_instruction}</p>
          <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4 max-w-5xl mx-auto">
            ${names.map((item, index) => `
              <div class="card rounded-2xl shadow p-4" style="background: ${config.card_color}; border-bottom: 5px solid ${item.color};"
                   onclick="handleCardClick(${index}, this)">
                <div class="text-5xl mb-2">${item.emoji}</div>
                <h3 style="color: ${config.text_color};" class="text-2xl font-black">${item.name}</h3>
              </div>`).join('')}
          </div>`;
      } else if (currentMode === 'memory') {
        content += `
          <div style="background: ${config.secondary_color};" class="inline-block px-6 py-1 rounded-full mb-6">
            <p style="color: white;" class="text-xl font-black">Ø§Ù„Ù†Ù‚Ø§Ø·: <span id="score">${score}</span></p>
          </div>
          <div class="grid grid-cols-3 sm:grid-cols-4 gap-3 max-w-2xl mx-auto">
            ${memoryPairs.map((item, index) => `
              <div class="card rounded-xl shadow-lg h-24 flex items-center justify-center text-4xl text-white" 
                   style="background: ${config.primary_color};"
                   onclick="handleMemoryClick(this, ${index})">â“</div>`).join('')}
          </div>`;
      } else {
        const target = names[Math.floor(Math.random() * names.length)];
        const options = shuffleArray([target, ...shuffleArray(names.filter(n => n.name !== target.name)).slice(0, 3)]);
        content += `
          <div style="background: ${config.secondary_color};" class="inline-block px-6 py-1 rounded-full mb-6">
            <p style="color: white;" class="text-xl font-black">Ø§Ù„Ù†Ù‚Ø§Ø·: <span id="quiz-score">${score}</span></p>
          </div>
          <div style="background: ${config.card_color};" class="max-w-md mx-auto rounded-3xl shadow-xl p-6 border-4 border-white">
            <div class="text-8xl mb-6 balloon">${target.emoji}</div>
            <div class="grid grid-cols-2 gap-3">
              ${options.map(opt => `
                <button style="background: ${config.secondary_color};" 
                  class="py-4 rounded-xl text-xl font-black shadow text-white transition-colors"
                  onclick="handleQuizAnswer('${opt.name}', '${target.name}', this)">${opt.name}</button>`).join('')}
            </div>
            <div id="quiz-feedback" class="mt-6 text-2xl font-black min-h-[2rem]"></div>
          </div>`;
      }

      content += `</div>`;
      app.innerHTML = content;
    }

    // Initial load
    window.addEventListener('load', () => {
        // Pre-load voices
        if ('speechSynthesis' in window) {
            speechSynthesis.getVoices();
        }
        render();
    });
  </script>
 </body>
</html>
