<!doctype html>
<html lang="en" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Arabic Alphabet Adventure</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    if (!window.elementSdk) {
      window.elementSdk = {
        init: (cfg) => { window.elementSdk.config = cfg.defaultConfig; cfg.onConfigChange(cfg.defaultConfig); },
        setConfig: (cfg) => { Object.assign(window.elementSdk.config, cfg); }
      };
    }
    if (!window.dataSdk) {
      window.dataSdk = {
        init: (h) => { h.onDataChanged([]); return { isOk: true }; },
        create: (d) => ({ isOk: true }),
        update: (d) => ({ isOk: true })
      };
    }
  </script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap');
    
    * { font-family: 'Tajawal', Arial, sans-serif; box-sizing: border-box; }
    
    .card-container { perspective: 1000px; height: 400px; width: 100%; max-width: 320px; margin: 0 auto; }
    .card { 
        position: relative; width: 100%; height: 100%; 
        transition: transform 0.8s cubic-bezier(0.4, 0, 0.2, 1); 
        transform-style: preserve-3d; 
    }
    .card.flipped { transform: rotateY(180deg); }
    
    .card-face {
      position: absolute; width: 100%; height: 100%;
      backface-visibility: hidden; -webkit-backface-visibility: hidden;
      border-radius: 1.5rem; display: flex; flex-direction: column;
      align-items: center; justify-content: center;
      box-shadow: 0 15px 35px rgba(0,0,0,0.1);
    }
    
    .card-back { transform: rotateY(180deg); }
    
    .confetti {
      position: fixed; pointer-events: none; z-index: 1000;
      width: 10px; height: 10px; animation: fall 3s linear forwards;
    }
    
    @keyframes fall {
      to { transform: translateY(100vh) rotate(720deg); opacity: 0; }
    }

    .pulse { animation: pulse 0.5s ease-in-out; }
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }
  </style>
 </head>
 <body class="h-full">
  <div id="app" class="h-full w-full overflow-auto bg-indigo-600"></div>

  <script>
    const defaultConfig = {
      background_color: "#4F46E5",
      card_color: "#FFFFFF",
      primary_button_color: "#10B981",
      secondary_button_color: "#F59E0B",
      text_color: "#1F2937",
      game_title: "ğŸŒŸ Arabic Alphabet Adventure! ğŸŒŸ",
      instruction_text: "Flip cards and earn stars! Can you master all 28 letters?"
    };

    const arabicLetters = [
      { letter: "Ø§", name: "Alif", transliteration: "a", emoji: "ğŸŒ™", sound: "ah" },
      { letter: "Ø¨", name: "Ba", transliteration: "b", emoji: "ğŸ¦‹", sound: "baa" },
      { letter: "Øª", name: "Ta", transliteration: "t", emoji: "â­", sound: "taa" },
      { letter: "Ø«", name: "Tha", transliteration: "th", emoji: "ğŸŒº", sound: "thaa" },
      { letter: "Ø¬", name: "Jeem", transliteration: "j", emoji: "ğŸŒˆ", sound: "jeem" },
      { letter: "Ø­", name: "Ha", transliteration: "h", emoji: "ğŸ¨", sound: "haa" },
      { letter: "Ø®", name: "Kha", transliteration: "kh", emoji: "ğŸª", sound: "khaa" },
      { letter: "Ø¯", name: "Dal", transliteration: "d", emoji: "ğŸµ", sound: "daal" },
      { letter: "Ø°", name: "Thal", transliteration: "dh", emoji: "ğŸŒ»", sound: "thaal" },
      { letter: "Ø±", name: "Ra", transliteration: "r", emoji: "ğŸ", sound: "raa" },
      { letter: "Ø²", name: "Zay", transliteration: "z", emoji: "ğŸŒ¸", sound: "zaay" },
      { letter: "Ø³", name: "Seen", transliteration: "s", emoji: "â˜€ï¸", sound: "seen" },
      { letter: "Ø´", name: "Sheen", transliteration: "sh", emoji: "âœ¨", sound: "sheen" },
      { letter: "Øµ", name: "Sad", transliteration: "s", emoji: "ğŸ€", sound: "saad" },
      { letter: "Ø¶", name: "Dad", transliteration: "d", emoji: "ğŸŒŸ", sound: "daad" },
      { letter: "Ø·", name: "Ta", transliteration: "t", emoji: "ğŸ­", sound: "taa" },
      { letter: "Ø¸", name: "Za", transliteration: "z", emoji: "ğŸª", sound: "zaa" },
      { letter: "Ø¹", name: "Ayn", transliteration: "'", emoji: "ğŸ¦„", sound: "ayn" },
      { letter: "Øº", name: "Ghayn", transliteration: "gh", emoji: "ğŸŒº", sound: "ghayn" },
      { letter: "Ù", name: "Fa", transliteration: "f", emoji: "ğŸ¨", sound: "faa" },
      { letter: "Ù‚", name: "Qaf", transliteration: "q", emoji: "ğŸ¯", sound: "qaaf" },
      { letter: "Ùƒ", name: "Kaf", transliteration: "k", emoji: "ğŸˆ", sound: "kaaf" },
      { letter: "Ù„", name: "Lam", transliteration: "l", emoji: "ğŸŒˆ", sound: "laam" },
      { letter: "Ù…", name: "Meem", transliteration: "m", emoji: "ğŸµ", sound: "meem" },
      { letter: "Ù†", name: "Noon", transliteration: "n", emoji: "ğŸŒ™", sound: "noon" },
      { letter: "Ù‡", name: "Ha", transliteration: "h", emoji: "â­", sound: "haa" },
      { letter: "Ùˆ", name: "Waw", transliteration: "w", emoji: "ğŸ¦‹", sound: "waaw" },
      { letter: "ÙŠ", name: "Ya", transliteration: "y", emoji: "ğŸŒ»", sound: "yaa" }
    ];

    let currentIndex = 0;
    let isFlipped = false;
    let userProgress = [];
    let totalStars = 0;
    let showingGrid = false;

    function speak(text) {
      if ('speechSynthesis' in window) {
        const msg = new SpeechSynthesisUtterance(text);
        msg.lang = 'ar-SA';
        speechSynthesis.speak(msg);
      }
    }

    function createConfetti() {
      for(let i=0; i<40; i++) {
        const c = document.createElement('div');
        c.className = 'confetti';
        c.style.left = Math.random() * 100 + 'vw';
        c.style.backgroundColor = `hsl(${Math.random() * 360}, 70%, 60%)`;
        document.body.appendChild(c);
        setTimeout(() => c.remove(), 3000);
      }
    }

    window.toggleFlip = function() {
      isFlipped = !isFlipped;
      document.getElementById('card-inner').classList.toggle('flipped');
      if (isFlipped) speak(arabicLetters[currentIndex].letter);
    };

    window.nextLetter = function(earnedStar) {
      if (earnedStar) {
        totalStars++;
        createConfetti();
      }
      currentIndex = (currentIndex + 1) % arabicLetters.length;
      isFlipped = false;
      render();
    };

    window.goToLetter = function(index) {
      currentIndex = index;
      showingGrid = false;
      isFlipped = false;
      render();
    };

    function render() {
      const app = document.getElementById('app');
      const cfg = window.elementSdk.config || defaultConfig;
      const current = arabicLetters[currentIndex];

      if (showingGrid) {
        app.innerHTML = `
          <div class="p-6 text-white">
            <div class="flex justify-between items-center mb-6">
               <h2 class="text-2xl font-black">All Letters</h2>
               <button onclick="showingGrid=false; render()" class="bg-white/20 px-4 py-2 rounded-lg">Back</button>
            </div>
            <div class="grid grid-cols-4 gap-3">
              ${arabicLetters.map((l, i) => `
                <div onclick="goToLetter(${i})" class="bg-white rounded-xl p-4 text-center cursor-pointer">
                  <div class="text-3xl font-bold text-gray-800">${l.letter}</div>
                </div>
              `).join('')}
            </div>
          </div>
        `;
        return;
      }

      app.innerHTML = `
        <div class="flex flex-col items-center justify-between min-h-full p-6" style="background:${cfg.background_color}">
          <div class="text-center text-white">
            <h1 class="text-2xl font-black mb-1">${cfg.game_title}</h1>
            <p class="opacity-80">${cfg.instruction_text}</p>
            <div class="mt-4 inline-block bg-yellow-400 text-indigo-900 px-4 py-1 rounded-full font-bold">
              â­ ${totalStars} Stars
            </div>
          </div>

          <div class="card-container my-8">
            <div class="card" id="card-inner">
              <div class="card-face bg-white">
                <div class="text-8xl font-black text-gray-800">${current.letter}</div>
                <div class="mt-8 text-gray-400 font-bold animate-pulse">Tap Flip to Learn</div>
              </div>
              <div class="card-face card-back bg-white p-6 text-center">
                <div class="text-6xl mb-2">${current.emoji}</div>
                <div class="text-6xl font-black text-indigo-600 mb-2">${current.letter}</div>
                <div class="text-2xl font-black text-gray-800">${current.name}</div>
                <div class="text-gray-500 font-bold italic">"${current.sound}"</div>
              </div>
            </div>
          </div>

          <div class="w-full max-w-sm space-y-3">
            <button onclick="toggleFlip()" class="w-full py-4 rounded-2xl text-white font-black text-xl shadow-lg" style="background:${cfg.primary_button_color}">
              ğŸ”„ Flip & Listen
            </button>
            <div class="flex gap-3">
              <button onclick="nextLetter(true)" class="flex-1 py-3 bg-white/20 text-white rounded-xl font-bold">âœ¨ I Know It!</button>
              <button onclick="nextLetter(false)" class="flex-1 py-3 bg-white/20 text-white rounded-xl font-bold">ğŸ” Practice</button>
            </div>
            <button onclick="showingGrid=true; render()" class="w-full text-white/60 font-bold py-2">ğŸ“‹ View All Letters</button>
          </div>
        </div>
      `;
    }

    window.elementSdk.init({
      defaultConfig,
      onConfigChange: () => render()
    });
  </script>
 </body>
</html>
